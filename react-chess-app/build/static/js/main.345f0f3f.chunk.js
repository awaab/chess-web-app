(this["webpackJsonpchess-app"]=this["webpackJsonpchess-app"]||[]).push([[0],{19:function(e,t,a){},34:function(e,t,a){e.exports=a(64)},61:function(e,t,a){e.exports=a.p+"static/media/logo.25bf045c.svg"},62:function(e,t,a){},64:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),l=a(29),s=a.n(l),r=(a(19),a(12)),c=a.n(r),i=a(6),u=a(7),m=a(10),h=a(8),p=a(9),d=a(15),g=a(30),E=a.n(g),f=a(16),w=a.n(f),v=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(h.a)(t).call(this,e))).makeMove=function(e,t,n){a.props.chessGame.move({from:e,to:t}),a.props.updateBoardCallback(a.props.chessGame.fen(),e+t)},a.displayOnConsole=function(){console.log(a.props.chessGame.ascii()),console.log(a.state),console.log(a.props.chessGame.turn())},a.onDrop=function(e){var t=e.sourceSquare,n=e.targetSquare,o=e.piece;a.makeMove(t,n,o)},a.onMessage=function(e){console.log(JSON.parse(e))},a.allowDrag=function(e){var t=e.piece,n=(e.sourceSquare,t.charAt(0));return n===a.props.chessGame.turn()&&(n==a.props.playerColor||void 0)},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(E.a,{position:this.props.position,onDrop:this.onDrop,allowDrag:this.allowDrag}))}}]),t}(n.Component),y=a(5),b=a.n(y),k=a(65),O=a(68),C=a(66),S=a(32),_=a(69),j="hello/",G="login/",N="signup/",x="user/",K="session/",T="csrf/";b.a.defaults.xsrfCookieName="csrftoken",b.a.defaults.xsrfHeaderName="X-CSRFTOKEN";var D=null;function I(){return L.apply(this,arguments)}function L(){return(L=Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===D&&b.a.get(T).then((function(e){console.log(e),D=e.data.csrfToken})),b.a.defaults.headers.common["X-CSRFTOKEN"]=D,e.abrupt("return",D);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(h.a)(t).call(this,e))).state={token:"",SessionKey:"",logged_in:!1},a.submit=function(e){I(),e.preventDefault();var t={username:e.target.username.value,password:e.target.password.value};console.log(t),console.log(e.target.username.value),b.a.post(G,t).then((function(e){a.setState({token:e.data.key}),console.log(e),a.getSessionKey(),a.setState({logged_in:!0}),a.props.setLoggedInCallback(!0)}),(function(e){console.log(e)}))},a.submit_signup=function(e){I(),e.preventDefault();var t={username:e.target.username.value,password1:e.target.password1.value,password2:e.target.password2.value};b.a.post(N,t).then((function(e){console.log(e),a.setState({logged_in:!0}),a.props.setLoggedInCallback(!0)}),(function(e){console.log(e)}))},a.getSessionKey=function(){b.a.get(K).then((function(e){console.log(e.data),a.setState({SessionKey:e.data.SessionKey}),console.log("SessionKey from login",e.data.SessionKey),a.props.setSessionKeyCallback(e.data.SessionKey)}))},a.sessionClick=function(e){console.log("YAAA"),b.a.get(K).then((function(e){console.log(e.data)}))},a.helloClick=function(e){console.log("YAAA"),b.a.get(j).then((function(e){console.log(e.data),b.a.get(x,{headers:{Aothorization:"Bearer"+a.state.token}}).then((function(e){console.log(e)}))}))},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"text-center"},o.a.createElement("h2",null,"Play Chess!"),o.a.createElement(k.a,{className:"text-center",style:{width:"50%"}},o.a.createElement(O.a,{onSubmit:this.submit},o.a.createElement(O.a.Group,{as:C.a,controlId:"username"},o.a.createElement(O.a.Control,{type:"text",placeholder:"User Name"})),o.a.createElement(O.a.Group,{as:C.a,controlId:"password"},o.a.createElement(O.a.Control,{type:"password",placeholder:"Password"})),o.a.createElement(O.a.Group,{as:C.a,controlId:"submitLogin"},o.a.createElement(S.a,{style:{width:"10%"}}),o.a.createElement(S.a,null,o.a.createElement(_.a,{variant:"primary",type:"submit",className:"text-center",style:{width:"250px"}},"Login")),o.a.createElement(S.a,{style:{width:"10%"}})))),o.a.createElement(k.a,{className:"text-center",style:{width:"50%"}},o.a.createElement(O.a,{onSubmit:this.submit_signup},o.a.createElement(O.a.Group,{as:C.a,controlId:"username"},o.a.createElement(O.a.Control,{type:"text",placeholder:"User name"})),o.a.createElement(O.a.Group,{as:C.a,controlId:"password1"},o.a.createElement(O.a.Control,{type:"password",placeholder:"Password"})),o.a.createElement(O.a.Group,{as:C.a,controlId:"password2"},o.a.createElement(O.a.Control,{type:"password",placeholder:"Repeat password"})),o.a.createElement(O.a.Group,{as:C.a,controlId:"submitSignup"},o.a.createElement(S.a,{style:{width:"10%"}}),o.a.createElement(S.a,null,o.a.createElement(_.a,{variant:"primary",type:"submit",className:"btn btn-primary",style:{backgroundColor:"#B9732F",width:"250px"}},"Signup")),o.a.createElement(S.a,{style:{width:"10%"}})))))}}]),t}(n.Component),B=a(33),P=a(14);b.a.defaults.xsrfCookieName="csrftoken",b.a.defaults.xsrfHeaderName="X-CSRFTOKEN";var A="endgame/",H=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(m.a)(this,Object(h.a)(t).call(this,e))).state={position:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",moves:[],gameOver:!1},a.depth={1:1,2:3,3:5,4:7,5:9,6:10},a.nextTurn=function(e){console.log("In chessgame turn: ",e),console.log("++++++++++++++++++++"),e===a.props.playerColor?console.log("Your turn"):(console.log("Oponents turn"),a.playOponentsTurn())},a.addMove=function(e){console.log("addMove()"),console.log(e),console.log(a.chessGame.turn()),a.setState((function(t,a){return{moves:[].concat(Object(B.a)(t.moves),[e])}})),console.log(a.state.moves)},a.updateBoard=function(e,t){a.addMove(t),a.setState((function(t,a){return{position:e}})),a.displayOnConsole(),a.chessGame.game_over()&&a.endGame(),a.nextTurn(a.chessGame.turn())},a.endGame=function(){a.setState({gameOver:!0});var e="b"===a.chessGame.turn()?"W":"B",t="w"===a.props.playerColor?"user":"level"+a.props.level,n="b"===a.props.playerColor?"user":"level"+a.props.level,o=(new Date).getTime()/1e3-a.start_timestamp/1e3;console.log("duration",o);var l={winner:e,white_player:t,black_player:n,duration:o};console.log("GAM ENDED"),console.log(a.chessGame.turn()),b.a.post(A,l).then((function(e){console.log(e)}),(function(e){console.log(e)}))},a.displayOnConsole=function(){console.log(a.chessGame.ascii()),console.log(a.state),console.log(a.chessGame.turn())},a.makeMove=function(e){console.log("MAKEMOVE"),console.log(a.chessGame.ascii()),console.log(e);var t=e.substr(0,2),n=e.substr(2,4);a.chessGame.move({from:t,to:n}),console.log(a.chessGame.ascii()),a.updateBoard(a.chessGame.fen(),e)},a.playOponentsTurn=function(){console.log("playOponentsTurn",a.chessGame.turn()),a.stockfish.postMessage("position fen "+a.state.position);var e=a.depth[a.props.level];console.log("go depth "+e),a.stockfish.postMessage("go depth "+e)},a.stockfish=new Worker("static/stockfish.js"),a.chessGame=new w.a;var n=new Date;a.start_timestamp=n.getTime();var o=Object(P.a)(a);return a.stockfish.onmessage=function(e){if(e.data.startsWith("bestmove")){console.log(e.data);var t=e.data.split(" ")[1];o.makeMove(t)}else console.log("NOT event.data.startsWith('bestmove')");"uciok"==e.data&&console.log("UUCCII OOKK")},a.stockfish.postMessage("uci"),a.nextTurn("w"),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(k.a,null,o.a.createElement(C.a,{className:"text-center"},o.a.createElement(S.a,null),o.a.createElement(S.a,null,!this.state.gameOver&&o.a.createElement("h3",null,"Playing against AI level ",this.props.level," "),this.state.gameOver&&o.a.createElement("h2",null,"Game Over")),o.a.createElement(S.a,null)),o.a.createElement(C.a,{className:"text-center"},o.a.createElement(S.a,null),o.a.createElement(S.a,null,o.a.createElement(v,{chessGame:this.chessGame,position:this.state.position,nextTurnCallback:this.nextTurn,updateBoardCallback:this.updateBoard,moveDoneCallback:this.moveDone,playerColor:this.props.playerColor})),o.a.createElement(S.a,null)),o.a.createElement(C.a,null,o.a.createElement("h3",null)),o.a.createElement(C.a,{className:"text-center"},o.a.createElement(S.a,null),o.a.createElement(S.a,null,o.a.createElement(_.a,{onClick:this.props.showHome,style:{width:"40%"}},"Quit game")),o.a.createElement(S.a,null))))}}]),t}(n.Component),W=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(h.a)(t).call(this,e))).state={show_options:!0,show_game:!1,color:"w",level:1},a.handleSubmit=function(e){e.preventDefault(),a.setState({show_options:!1,show_game:!0})},a.handleLevelChange=function(e){a.setState({level:e.target.value})},a.handleColorChange=function(e){a.setState({color:e.target.value})},a.endGame=function(){a.props.endGameCallback()},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,this.state.show_options&&o.a.createElement("div",{className:"centered",style:{width:"50%"}},o.a.createElement("h3",null,"Game Options"),o.a.createElement(k.a,null,o.a.createElement(O.a,{onSubmit:this.handleSubmit},o.a.createElement(O.a.Group,{controlId:"difficulty.level"},o.a.createElement(O.a.Label,null,"Select difficulty level"),o.a.createElement(O.a.Control,{as:"select",value:this.state.level,onChange:this.handleLevelChange},o.a.createElement("option",{value:1},"One"),o.a.createElement("option",{value:2},"Two"),o.a.createElement("option",{value:3},"Three"),o.a.createElement("option",{value:4},"Four"),o.a.createElement("option",{value:5},"Five"),o.a.createElement("option",{value:6},"Six"))),o.a.createElement("p",null),o.a.createElement(O.a.Label,{as:"Row"},"Select color"),o.a.createElement(O.a.Check,{type:"radio",value:"w",checked:"w"===this.state.color,onChange:this.handleColorChange,id:"white",label:"White"}),o.a.createElement(O.a.Check,{type:"radio",value:"b",checked:"b"===this.state.color,onChange:this.handleColorChange,id:"black",label:"Black"}),o.a.createElement(O.a.Group,{as:C.a,controlId:"Play",className:"text-center"},o.a.createElement(S.a,{style:{width:"10%"}}),o.a.createElement(S.a,null,o.a.createElement(_.a,{variant:"primary",type:"submit",style:{width:"140px"},className:"btn btn-primary"},"Play now")),o.a.createElement(S.a,{style:{width:"10%"}}))))),this.state.show_game&&o.a.createElement(n.Fragment,null,o.a.createElement(H,{showHome:this.props.showHome,playerColor:this.state.color,level:this.state.level,endGameCallback:this.endGame})))}}]),t}(n.Component),R=a(67);b.a.defaults.xsrfCookieName="csrftoken",b.a.defaults.xsrfHeaderName="X-CSRFTOKEN";var F="games_played/",X=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(h.a)(t).call(this,e))).state={gameList:[],won:-1,lost:-1,draw:-1,played:-1,user:""},a.setStats=function(e){a.setState({gameList:e.games_list,won:e.won,lost:e.lost,draw:e.draw,played:e.played,user:e.user}),console.log(a.state)},a.resultString=function(e){return"D"===e.winner?"DRAW":"W"===e.winner?e.white_player===a.state.user?"WON":"LOST":"B"===e.winner?e.black_player===a.state.user?"WON":"LOST":void 0},b.a.get(F).then((function(e){console.log(e.data),a.setStats(e.data)})),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement(k.a,null,o.a.createElement(C.a,null,o.a.createElement("h2",null)),o.a.createElement(C.a,null,o.a.createElement(S.a,{style:{width:"25%"}}),o.a.createElement(S.a,null,o.a.createElement("h4",null,"Total games played: ",this.state.played)),o.a.createElement(S.a,{style:{width:"25%"}})),o.a.createElement(C.a,null,o.a.createElement(S.a,{style:{width:"35%"}}),o.a.createElement(S.a,null,o.a.createElement("p",null,"Won: ",this.state.won)," "),o.a.createElement(S.a,null,o.a.createElement("p",null,"Lost: ",this.state.lost)," "),o.a.createElement(S.a,null,o.a.createElement("p",null,"Draw: ",this.state.draw)," "),o.a.createElement(S.a,{style:{width:"35%"}}))),o.a.createElement(k.a,null,o.a.createElement(R.a,{striped:!0,bordered:!0,hover:!0,size:"sm"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Result"),o.a.createElement("th",null,"White"),o.a.createElement("th",null),o.a.createElement("th",null,"Black"),o.a.createElement("th",null,"Date"),o.a.createElement("th",null,"Duration"))),o.a.createElement("tbody",null,this.state.gameList.map((function(t){return o.a.createElement("tr",null,o.a.createElement("td",null,e.resultString(t)),o.a.createElement("td",null,t.white_player," "),o.a.createElement("td",null,"vs "),o.a.createElement("td",null," ",t.black_player),o.a.createElement("td",null,t.started_at," "),o.a.createElement("td",null,t.duration," "))})))),o.a.createElement(C.a,null,o.a.createElement(S.a,null),o.a.createElement(S.a,null,o.a.createElement(_.a,{onClick:this.props.showHome,style:{width:"80%"}},"Back to main menu")),o.a.createElement(S.a,null))))}}]),t}(n.Component),q="logout/",J=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(h.a)(t).call(this,e))).state={show_home:!0,show_stats:!1,show_options:!1},a.logOut=function(){b.a.post(q).then((function(e){console.log(e),a.props.setLoggedInCallback(!1)}))},a.showStats=function(){console.log("showStats"),a.setState({show_home:!1,show_stats:!0,show_options:!1})},a.showHome=function(){console.log("showStats"),a.setState({show_home:!0,show_stats:!1,show_options:!1})},a.showOptions=function(){a.setState({show_home:!1,show_stats:!1,show_options:!0})},a.endGame=function(){a.showHome()},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(k.a,null,this.state.show_home&&o.a.createElement("div",{className:"centered"},o.a.createElement(k.a,null,o.a.createElement("h2",{style:{width:"40%",textAlign:"center"}},"Home ")),o.a.createElement(k.a,null,o.a.createElement(_.a,{onClick:this.showStats,style:{width:"40%"}},"Show Stats")),o.a.createElement("p",null),o.a.createElement(k.a,null,o.a.createElement(_.a,{onClick:this.showOptions,style:{width:"40%"}},"Play against AI")),o.a.createElement("p",null),o.a.createElement(k.a,null,o.a.createElement(_.a,{disabled:!0,style:{width:"40%"}},"Play against online players")),o.a.createElement("p",null),o.a.createElement(k.a,null,o.a.createElement(_.a,{onClick:this.logOut,style:{width:"40%"}},"Logout"))),this.state.show_stats&&o.a.createElement(X,{showHome:this.showHome}),this.state.show_options&&o.a.createElement(n.Fragment,null,o.a.createElement(W,{showHome:this.showHome,endGameCallback:this.endGame}))))}}]),t}(n.Component),U=(a(61),a(62),a(63),"csrf/");b.a.defaults.xsrfCookieName="csrftoken",b.a.defaults.xsrfHeaderName="X-CSRFTOKEN";var Q=null;function Y(){return(Y=Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===Q&&b.a.get(U).then((function(e){console.log(e),Q=e.data.csrfToken})),b.a.defaults.headers.common["X-CSRFTOKEN"]=Q,e.abrupt("return",Q);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var z=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(h.a)(t).call(this,e))).state={message_to_send:"Message No. 0",messages_recieved:[],token:"",logged_in:!1,SessionKey:"DefaultAppjs"},a.handleData=function(e){JSON.parse(e);console.log(e)},a.setLoggedIn=function(e){a.setState({logged_in:e})},a.setSessionKey=function(e){a.setState({SessionKey:e}),console.log(a.state),console.log("SessionKey from appjs",e)},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;!function(){Y.apply(this,arguments)}(),console.log("componentDidMount token=",this.state.token),b.a.post("logged-in/").then((function(t){console.log(t),e.setState({logged_in:!0})}))}},{key:"render",value:function(){return o.a.createElement("div",null,!this.state.logged_in&&o.a.createElement(M,{setTokenCallback:this.setToken,setLoggedInCallback:this.setLoggedIn,setSessionKeyCallback:this.setSessionKey}),this.state.logged_in&&o.a.createElement(J,{setLoggedInCallback:this.setLoggedIn}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[34,1,2]]]);
//# sourceMappingURL=main.345f0f3f.chunk.js.map